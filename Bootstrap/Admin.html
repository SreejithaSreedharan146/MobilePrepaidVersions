<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Mobi-comm</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            background-color: #f5f6fa;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: #32336c;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .alert-section {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .alert-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .search-bar {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .search-bar input {
            padding: 8px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            width: 300px;
        }

        .subscriber-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .subscriber-card {
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s;
        }

        .subscriber-card:hover {
            transform: translateY(-2px);
        }

        .subscriber-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .expiry-tag {
            background: #ff4757;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
        }

        .subscriber-details {
            margin-top: 10px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
        }

        .recharge-history {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .recharge-history th,
        .recharge-history td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .recharge-history th {
            background: #f8f9fa;
            font-weight: 600;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #32336c;
            margin-top: 10px;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .action-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s;
        }

        .primary-btn {
            background: #32336c;
            color: white;
        }

        .secondary-btn {
            background: #e9ecef;
            color: #495057;
        }

        .action-btn:hover {
            opacity: 0.9;
        }

        .tab-container {
            margin-bottom: 20px;
        }

        .tab-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background: #e9ecef;
            color: #495057;
        }

        .tab-btn.active {
            background: #32336c;
            color: white;
        }

        .table-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .form-container {
            display: none;
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
        }

        .form-group input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <div class="header">
            <h1>Admin Dashboard</h1>
            <div class="search-bar">
                <input type="text" placeholder="Search subscribers..." id="searchInput">
                <button class="action-btn primary-btn">Search</button>
            </div>
        </div>

        <div class="stats-container">
            <div class="stat-card">
                <div>Total Active Subscribers</div>
                <div class="stat-value" id="total-subscribers">0</div>
            </div>
            <div class="stat-card">
                <div>Plans Expiring Today</div>
                <div class="stat-value" id="expiring-plans">0</div>
            </div>
            <div class="stat-card">
                <div>Total Plans</div>
                <div class="stat-value" id="total-plans">0</div>
            </div>
            <div class="stat-card">
                <div>Active Offers</div>
                <div class="stat-value" id="active-offers">0</div>
            </div>
        </div>

        <div class="tab-container">
            <div class="tab-buttons">
                <button class="tab-btn active" data-tab="subscribers">Subscribers</button>
                <button class="tab-btn" data-tab="plans">Plans</button>
                <button class="tab-btn" data-tab="offers">Offers</button>
                <button class="tab-btn" data-tab="activities">Activities</button>
            </div>
        </div>

        <!-- Subscribers Section -->
        <div id="subscribers-tab" class="tab-content">
            <div class="alert-section">
                <div class="alert-header">
                    <h2>Plans Expiring Soon</h2>
                    <span class="expiry-tag">Next 3 Days</span>
                </div>
                <div class="subscriber-grid" id="subscriberGrid"></div>
            </div>
        </div>

        <!-- Plans Section -->
        <div id="plans-tab" class="tab-content" style="display: none;">
            <button class="action-btn primary-btn" onclick="showAddPlanForm()">Add New Plan</button>
            <div id="add-plan-form" class="form-container">
                <h2>Add New Plan</h2>
                <form id="planForm">
                    <div class="form-group">
                        <label>Plan Name</label>
                        <input type="text" name="planName" required>
                    </div>
                    <div class="form-group">
                        <label>Data Limit</label>
                        <input type="text" name="dataLimit" required>
                    </div>
                    <div class="form-group">
                        <label>Validity (days)</label>
                        <input type="number" name="validity" required>
                    </div>
                    <div class="form-group">
                        <label>Price</label>
                        <input type="number" name="price" required>
                    </div>
                    <div class="action-buttons">
                        <button type="submit" class="action-btn primary-btn">Add Plan</button>
                        <button type="button" class="action-btn secondary-btn" onclick="hideAddPlanForm()">Cancel</button>
                    </div>
                </form>
            </div>
            <div class="table-container">
                <table id="plans-table">
                    <thead>
                        <tr>
                            <th>Plan Name</th>
                            <th>Data</th>
                            <th>Validity</th>
                            <th>Price</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Offers Section -->
        <div id="offers-tab" class="tab-content" style="display: none;">
            <button class="action-btn primary-btn" onclick="showAddOfferForm()">Add New Offer</button>
            <div id="add-offer-form" class="form-container">
                <h2>Add New Offer</h2>
                <form id="offerForm">
                    <div class="form-group">
                        <label>Offer Name</label>
                        <input type="text" name="offerName" required>
                    </div>
                    <div class="form-group">
                        <label>Discount (%)</label>
                        <input type="number" name="discount" required>
                    </div>
                    <div class="form-group">
                        <label>Valid Until</label>
                        <input type="date" name="validUntil" required>
                    </div>
                    <div class="action-buttons">
                        <button type="submit" class="action-btn primary-btn">Add Offer</button>
                        <button type="button" class="action-btn secondary-btn" onclick="hideAddOfferForm()">Cancel</button>
                    </div>
                </form>
            </div>
            <div class="table-container">
                <table id="offers-table">
                    <thead>
                        <tr>
                            <th>Offer Name</th>
                            <th>Discount</th>
                            <th>Valid Until</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Activities Section -->
        <div id="activities-tab" class="tab-content" style="display: none;">
            <div class="table-container">
                <table id="activities-table">
                    <thead>
                        <tr>
                            <th>Activity</th>
                            <th>User</th>
                            <th>Date</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Subscriber Details Modal -->
    <div class="modal" id="subscriberModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Subscriber Details</h2>
                <button class="close-btn">&times;</button>
            </div>
            <div id="subscriberDetails"></div>
        </div>
    </div>

    <script>
        const subscribers = [
            {
                id: 1,
                name: "John Doe",
                phone: "+91 98765 43210",
                planExpiry: "2025-02-22",
                currentPlan: "Premium 5G",
                balance: "₹45.20",
                daysLeft: 2,
                rechargeHistory: [
                    { date: "2025-01-15", plan: "Premium 5G", amount: "₹599", mode: "Credit Card" },
                    { date: "2024-12-15", plan: "Premium 5G", amount: "₹599", mode: "UPI" }
                ]
            },
            {
                id: 2,
                name: "Sarah Smith",
                phone: "+91 87654 32109",
                planExpiry: "2025-02-21",
                currentPlan: "Standard 4G",
                balance: "₹32.50",
                daysLeft: 1,
                rechargeHistory: [
                    { date: "2025-01-20", plan: "Standard 4G", amount: "₹399", mode: "UPI" },
                    { date: "2024-12-20", plan: "Standard 4G", amount: "₹399", mode: "Credit Card" }
                ]
            },
            {
                id: 3,
                name: "Michael Johnson",
                phone: "+91 76543 21098",
                planExpiry: "2025-02-23",
                currentPlan: "Basic 4G",
                balance: "₹28.75",
                daysLeft: 3,
                rechargeHistory: [
                    { date: "2025-01-23", plan: "Basic 4G", amount: "₹299", mode: "UPI" }
                ]
            },
            {
                id: 4,
                name: "Emily Brown",
                phone: "+91 65432 10987",
                planExpiry: "2025-02-21",
                currentPlan: "Premium 5G",
                balance: "₹52.30",
                daysLeft: 1,
                rechargeHistory: [
                    { date: "2025-01-21", plan: "Premium 5G", amount: "₹599", mode: "Net Banking" }
                ]
            },
            {
                id: 5,
                name: "David Wilson",
                phone: "+91 54321 09876",
                planExpiry: "2025-02-22",
                currentPlan: "Standard 4G",
                balance: "₹41.60",
                daysLeft: 2,
                rechargeHistory: [
                    { date: "2025-01-22", plan: "Standard 4G", amount: "₹399", mode: "Credit Card" }
                ]
            }
        ];

        const activities = [
            { id: 1, activity: "New Plan Added", user: "Admin", date: "2025-02-20 14:30", status: "Completed" },
            { id: 2, activity: "Reminder Sent", user: "System", date: "2025-02-20 14:15", status: "Completed" },
            { id: 3, activity: "Offer Modified", user: "Admin", date: "2025-02-20 13:45", status: "Completed" },
            { id: 4, activity: "User Subscription Renewed", user: "John Doe", date: "2025-02-20 13:30", status: "Completed" },
            { id: 5, activity: "New User Registered", user: "Emily Brown", date: "2025-02-20 13:00", status: "Completed" },
            { id: 6, activity: "Payment Failed", user: "Michael Johnson", date: "2025-02-20 12:45", status: "Failed" },
            { id: 7, activity: "Support Ticket Created", user: "Sarah Smith", date: "2025-02-20 12:30", status: "Pending" },
            { id: 8, activity: "Plan Upgraded", user: "David Wilson", date: "2025-02-20 12:15", status: "Completed" }
        ];

        // Function to display subscribers in a table format
        function createSubscriberTable() {
            const container = document.getElementById('subscriberGrid');
            container.innerHTML = `
                <table class="subscriber-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Phone</th>
                            <th>Current Plan</th>
                            <th>Balance</th>
                            <th>Days Left</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    </                    <tbody>
                        ${subscribers.filter(s => s.daysLeft <= 3).map(subscriber => `
                            <tr>
                                <td>${subscriber.name}</td>
                                <td>${subscriber.phone}</td>
                                <td>${subscriber.currentPlan}</td>
                                <td>${subscriber.balance}</td>
                                <td>${subscriber.daysLeft}</td>
                                <td>
                                    <button class="action-btn primary-btn" onclick="showSubscriberDetails(${subscriber.id})">View Details</button>
                                    <button class="action-btn secondary-btn" onclick="sendReminder(${subscriber.id})">Send Reminder</button>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        // Function to send reminder
        function sendReminder(subscriberId) {
            const subscriber = subscribers.find(s => s.id === subscriberId);
            const activity = {
                id: activities.length + 1,
                activity: "Reminder Sent",
                user: subscriber.name,
                date: new Date().toLocaleString(),
                status: "Completed"
            };
            activities.unshift(activity);
            populateActivitiesTable();
            alert(`Reminder sent to ${subscriber.name}`);
        }

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const filteredSubscribers = subscribers.filter(subscriber => 
                subscriber.name.toLowerCase().includes(searchTerm) ||
                subscriber.phone.includes(searchTerm) ||
                subscriber.currentPlan.toLowerCase().includes(searchTerm)
            );
            
            const container = document.getElementById('subscriberGrid');
            container.innerHTML = `
                <table class="subscriber-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Phone</th>
                            <th>Current Plan</th>
                            <th>Balance</th>
                            <th>Days Left</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${filteredSubscribers.map(subscriber => `
                            <tr>
                                <td>${subscriber.name}</td>
                                <td>${subscriber.phone}</td>
                                <td>${subscriber.currentPlan}</td>
                                <td>${subscriber.balance}</td>
                                <td>${subscriber.daysLeft}</td>
                                <td>
                                    <button class="action-btn primary-btn" onclick="showSubscriberDetails(${subscriber.id})">View Details</button>
                                    <button class="action-btn secondary-btn" onclick="sendReminder(${subscriber.id})">Send Reminder</button>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        });

        // Plan management functions
        function showAddPlanForm() {
            document.getElementById('add-plan-form').style.display = 'block';
        }

        function hideAddPlanForm() {
            document.getElementById('add-plan-form').style.display = 'none';
        }

        document.getElementById('planForm').addEventListener('submit', function (event) {
            event.preventDefault(); // Prevent the default form submission

            const planName = document.getElementsByName('planName')[0].value;
            const dataLimit = document.getElementsByName('dataLimit')[0].value;
            const validity = document.getElementsByName('validity')[0].value;
            const price = document.getElementsByName('price')[0].value;

            const newPlan = {
                id: plans.length + 1,
                name: planName,
                data: dataLimit,
                validity: validity,
                price: price
            };

            plans.push(newPlan);
            populatePlansTable(); // Refresh the table with the new plan
            updateDashboardCards();
            hideAddPlanForm();

            // Clear form
            document.getElementById('planForm').reset();
        });

        // Offer management functions
        function showAddOfferForm() {
            document.getElementById('add-offer-form').style.display = 'block';
        }

        function hideAddOfferForm() {
            document.getElementById('add-offer-form').style.display = 'none';
        }

        document.getElementById('offerForm').addEventListener('submit', function (event) {
            event.preventDefault();

            const offerName = document.getElementsByName('offerName')[0].value;
            const discount = document.getElementsByName('discount')[0].value;
            const validUntil = document.getElementsByName('validUntil')[0].value;

            const newOffer = {
                id: offers.length + 1,
                name: offerName,
                discount: discount,
                validUntil: validUntil,
                status: 'Active'  // Default status
            };

            offers.push(newOffer);
            populateOffersTable();
            updateDashboardCards();
            hideAddOfferForm();

            // Clear form
            document.getElementById('offerForm').reset();
        });

        // Populate tables
        function populatePlansTable() {
            const plansTable = document.getElementById('plans-table').getElementsByTagName('tbody')[0];
            plansTable.innerHTML = ''; // Clear existing table rows

            plans.forEach(plan => {
                const row = plansTable.insertRow();
                row.insertCell(0).textContent = plan.name;
                row.insertCell(1).textContent = plan.data;
                row.insertCell(2).textContent = plan.validity;
                row.insertCell(3).textContent = plan.price;

                // Action Buttons (Edit and Delete)
                const actionsCell = row.insertCell(4);
                actionsCell.innerHTML = `
                    <button class="action-btn secondary-btn" onclick="editPlan(${plan.id})">Edit</button>
                    <button class="action-btn primary-btn" onclick="deletePlan(${plan.id})">Delete</button>
                `;
            });
        }

        function populateOffersTable() {
            const offersTable = document.getElementById('offers-table').getElementsByTagName('tbody')[0];
            offersTable.innerHTML = '';

            offers.forEach(offer => {
                const row = offersTable.insertRow();
                row.insertCell(0).textContent = offer.name;
                row.insertCell(1).textContent = offer.discount;
                row.insertCell(2).textContent = offer.validUntil;
                row.insertCell(3).textContent = offer.status;

                const actionsCell = row.insertCell(4);
                actionsCell.innerHTML = `
                    <button class="action-btn secondary-btn" onclick="editOffer(${offer.id})">Edit</button>
                    <button class="action-btn primary-btn" onclick="deleteOffer(${offer.id})">Delete</button>
                `;
            });
        }

        function populateActivitiesTable() {
            const activitiesTable = document.getElementById('activities-table').getElementsByTagName('tbody')[0];
            activitiesTable.innerHTML = '';

            activities.forEach(activity => {
                const row = activitiesTable.insertRow();
                row.insertCell(0).textContent = activity.activity;
                row.insertCell(1).textContent = activity.user;
                row.insertCell(2).textContent = activity.date;
                row.insertCell(3).textContent = activity.status;
            });
        }

        // Update Dashboard Cards
        function updateDashboardCards() {
            document.getElementById('total-subscribers').textContent = subscribers.length;
            document.getElementById('expiring-plans').textContent = subscribers.filter(subscriber => subscriber.daysLeft <= 3).length; // Assuming expiring plans
            document.getElementById('total-plans').textContent = plans.length;
            document.getElementById('active-offers').textContent = offers.length; // Assuming all offers are active
        }

        // Show Subscriber Details in Modal
        function showSubscriberDetails(subscriberId) {
            const subscriber = subscribers.find(s => s.id === subscriberId);
            const modal = document.getElementById('subscriberModal');
            const detailsContainer = document.getElementById('subscriberDetails');

            detailsContainer.innerHTML = `
                <div class="subscriber-details">
                    <div class="detail-row">
                        <strong>Name:</strong>
                        <span>${subscriber.name}</span>
                    </div>
                    <div class="detail-row">
                        <strong>Phone:</strong>
                        <span>${subscriber.phone}</span>
                    </div>
                    <div class="detail-row">
                        <strong>Current Plan:</strong>
                        <span>${subscriber.currentPlan}</span>
                    </div>
                    <div class="detail-row">
                        <strong>Expiry Date:</strong>
                        <span>${subscriber.planExpiry}</span>
                    </div>
                </div>
                <h3 style="margin: 20px 0">Recharge History</h3>
                <table class="recharge-history">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Plan</th>
                            <th>Amount</th>
                            <th>Payment Mode</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${subscriber.rechargeHistory.map(recharge => `
                            <tr>
                                <td>${recharge.date}</td>
                                <td>${recharge.plan}</td>
                                <td>${recharge.amount}</td>
                                <td>${recharge.mode}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;

            modal.style.display = 'flex'; // Show the modal
        }

        // Close modal functionality
        document.querySelector('.close-btn').addEventListener('click', () => {
            document.getElementById('subscriberModal').style.display = 'none';
        });

        // Tab switching functionality
        document.querySelectorAll('.tab-btn').forEach(button => {
            button.addEventListener('click', () => {
                // Remove active class from all tab buttons
                document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');

                // Hide all tab contents
                document.querySelectorAll('.tab-content').forEach(tab => tab.style.display = 'none');

                // Show the selected tab content
                const tabToShow = button.getAttribute('data-tab');
                document.getElementById(`${tabToShow}-tab`).style.display = 'block';

                if (tabToShow === 'subscribers') {
                    createSubscriberTable(); // Refresh subscriber table
                }
            });
        });

        // Initialize the dashboard
        createSubscriberTable();
        populatePlansTable();
        populateOffersTable();
        populateActivitiesTable();
        updateDashboardCards();
    </script>
</body>
</html>

